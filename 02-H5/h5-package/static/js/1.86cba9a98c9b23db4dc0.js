webpackJsonp([1],{"5zde":function(t,e,o){o("zQR9"),o("qyJz"),t.exports=o("FeBl").Array.from},Gu7T:function(t,e,o){"use strict";e.__esModule=!0;var s,i=o("c/Tr"),a=(s=i)&&s.__esModule?s:{default:s};e.default=function(t){if(Array.isArray(t)){for(var e=0,o=Array(t.length);e<t.length;e++)o[e]=t[e];return o}return(0,a.default)(t)}},IVfy:function(t,e){},"c/Tr":function(t,e,o){t.exports={default:o("5zde"),__esModule:!0}},eTw4:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o("Gu7T"),i=o.n(s),a=o("fqE/"),n=o("Au9i"),r=o("mtWM"),c=o.n(r),l=o("gyMJ"),d={name:"SaleAfter",components:{commonHeader:a.a,InfiniteScroll:n.InfiniteScroll,Indicator:n.Indicator,Button:n.Button,Lazyload:n.Lazyload,Toast:n.Toast},data:function(){return{imgPath:"https://share.gongzhugou.com/static/image/xcx_img/",h_title:"申请售后服务",procomm:"",track_name:"",track_number:"",uploadimg:[],uploadOk:!1,imgShow:!1,img_show_big:"",tempFilePaths:[],uploadimgList:[],imgs:[],ischose:"refunds",pid:"",order_Id:"",orderInfo:"",flag:0,order_type:"",hiddenUploadImg:!0,showToast:!1}},mounted:function(){n.Indicator.open("加载中..."),console.log(this.$route.query);var t=this.$route.query;this.pid=t.pid,this.order_Id=t.orderId,this.order_type=t.order_type,this.getInfo()},methods:{showUpload:function(){this.hiddenUploadImg=!1},hiddenModel:function(){this.hiddenUploadImg=!0},goTop:function(){console.log("回到顶部"),document.getElementById("coll").scrollIntoView({block:"start",behavior:"smooth"})},choseType:function(t){this.ischose=t},addImg:function(){console.log("选择相册");var t=this;document.getElementById("album").onchange=function(e){var o=e.target.files[0];console.log(o),o.size>5242880?Object(n.Toast)({message:"图片必须小于5MB！",duration:1e3}):(t.imgs.push(URL.createObjectURL(o)),t.tempFilePaths.push(o),t.hiddenUploadImg=!0,console.log(t.imgs),console.log(t.uploadimg))}},choseCra:function(){var t=this;console.log("选择拍照");var e=window.plus,o=e.camera.getCamera(),s=o.supportedImageResolutions[0],i=o.supportedImageFormats[0];console.log("Resolution: "+s+", Format: "+i),o.captureImage(function(o){e.io.resolveLocalFileSystemURL(o,function(o){var s="_doc/upload/"+o.name;e.zip.compressImage({src:o.toLocalURL(),dst:s,quality:40,overwrite:!0},function(o){console.log(o),e.io.resolveLocalFileSystemURL(o.target,function(o){console.log(o),o.file(function(o){if(console.log(o),o.size>5242880)Object(n.Toast)({message:"图片必须小于5MB！",duration:1e3});else{var s=new e.io.FileReader;s.readAsDataURL(o),s.onloadend=function(e){var s=t.dataURLtoBlob(e.target.result.toString());s.name=o.name,t.imgs.push(e.target.result.toString()),t.tempFilePaths.push(s),t.hiddenUploadImg=!0}}})})},function(t){console.log("压缩图片失败，请稍候再试")})},function(t){console.log("读取拍照文件错误："+t.message)})},function(t){console.log("Capture image failed: "+t.message)},{resolution:s,format:i})},dataURLtoBlob:function(t){for(var e=t.split(","),o=e[0].match(/:(.*?);/)[1],s=atob(e[1].replace(/\s/g,"")),i=s.length,a=new Uint8Array(i);i--;)a[i]=s.charCodeAt(i);return new Blob([a],{type:o})},delImg:function(t){var e=this.imgs,o=t;e.splice(o,1),this.imgs=e,this.uploadimg.splice(o,1),this.tempFilePaths.length>0&&o-this.uploadimg.length<this.tempFilePaths.length&&o-this.uploadimg.length>=0&&this.tempFilePaths.splice(o-this.uploadimg.length,1)},previewImg:function(t){!1===this.showToast&&(this.imgShow=!0,this.img_show_big=t)},hiddenImg:function(){this.imgShow=!1},getInfo:function(){var t=this,e={order_id:t.order_Id,product_id:t.pid};Object(l.z)(e).then(function(e){n.Indicator.close(),e.isSuccess&&(t.orderInfo=e.data,t.ischose=void 0===e.data.refund_info.type?"refunds":e.data.refund_info.type,t.procomm=void 0===e.data.refund_info.content?"":e.data.refund_info.content,t.imgs=[].concat(i()(void 0===e.data.refund_info.img||null===e.data.refund_info.img?[]:e.data.refund_info.img)),t.uploadimg=[].concat(i()(void 0===e.data.refund_info.img||null===e.data.refund_info.img?[]:e.data.refund_info.img)),t.flag=e.data.flag,t.track_name=void 0===e.data.refund_info.express?"":e.data.refund_info.express,t.track_number=void 0===e.data.refund_info.express_no?"":e.data.refund_info.express_no)})},saveAfter:function(t,e){if(console.log(this.order_Id),console.log(t),console.log(e),console.log(this.procomm),console.log(this.ischose),""===this.ischose)Object(n.Toast)({message:"请选择服务类型",duration:1e3});else if(2===this.flag&&""===this.track_name&&"refunds"!==this.ischose)Object(n.Toast)({message:"请填写快递公司",duration:1e3});else if(2===this.flag&&""===this.track_number&&"refunds"!==this.ischose)Object(n.Toast)({message:"请填写快递单号",duration:1e3});else if(this.procomm.length<=10)Object(n.Toast)({message:"售后理由必须大于10个字",duration:1e3});else{n.Indicator.open("提交中..."),this.showToast=!0;var o=this;if(console.log(o.tempFilePaths),console.log(o.uploadimg),o.tempFilePaths.length<=0){var s={order_id:this.order_Id,type:this.ischose,product_id:e,content:this.procomm,express:this.track_name,express_no:this.track_number,file_path:this.uploadimg.join(",")};Object(l._38)(s).then(function(t){n.Indicator.close(),o.showToast=!1,t.isSuccess?(Object(n.Toast)({message:"提交成功",iconClass:"iconfont icon-dui1",duration:1e3}),setTimeout(function(){o.$router.back()},1e3)):Object(n.Toast)({message:t.msg,duration:1e3})})}else o.uploadImg({path:o.tempFilePaths.slice(0,5-o.uploadimg.length),id:t,pid:e})}},uploadImg:function(t){var e=this,o=t.i?t.i:0,s=t.success?t.success:0,i=t.fail?t.fail:0,a=new FormData;a.append("file",t.path[o],t.path[o].name);var r="?m=order&a=imgsave";r="https://share.gongzhugou.com/"+r,console.log("请求上传接口啦"),c.a.post(r,a,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}).then(function(a){if(console.log(a),a.data.isSuccess?(s++,e.uploadimgList.push(a.data.data[0])):(i++,console.log("fail:"+o+"fail:"+i)),++o===t.path.length){if(console.log("成功："+s+" 失败："+i),e.uploadOk=!0,console.log(e.uploadimg),console.log(e.uploadimgList),e.uploadimgList=e.uploadimgList.concat(e.uploadimg),e.uploadOk){var r={order_id:e.order_Id,type:e.ischose,product_id:t.pid,content:e.procomm,express:e.track_name,express_no:e.track_number,file_path:e.uploadimgList.join(",")};Object(l._38)(r).then(function(t){t.isSuccess?(n.Indicator.close(),e.showToast=!1,Object(n.Toast)({message:"售后申请提交成功",iconClass:"iconfont icon-dui1",duration:1e3}),setTimeout(function(){"0"===e.allComm&&e.proNum>1?(e.morePro=!e.morePro,e.tempFilePaths=[],e.imgs=[],e.pNum=5,e.wNum=0,e.fNum=0,e.getOrder()):e.$router.back()},1e3)):Object(n.Toast)({message:t.msg,duration:1e3})})}}else t.i=o,t.success=s,t.fail=i,e.uploadImg(t)}).catch(function(t){console.log("请求出错")})}}},u={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("common-header",{attrs:{h_title:t.h_title,showback:!0}}),t._v(" "),o("return-top",{on:{returnTop:t.goTop}}),t._v(" "),o("div",{staticStyle:{height:"0.9rem"}}),t._v(" "),o("div",{staticClass:"sale_after"},[t._m(0),t._v(" "),o("div",{staticClass:"after_type"},[o("div",{staticClass:"after_title"},[t._v("服务类型")]),t._v(" "),o("div",{staticClass:"type_list"},[5==t.order_type?o("span",{class:"refunds"==t.ischose?"text_active":"",on:{click:function(e){return t.choseType("refunds")}}},[t._v("退款")]):t._e(),t._v(" "),5!=t.order_type?o("span",{class:"reship"==t.ischose?"text_active":"",on:{click:function(e){return t.choseType("reship")}}},[t._v("退货退款")]):t._e(),t._v(" "),5!=t.order_type?o("span",{class:"barter"==t.ischose?"text_active":"",on:{click:function(e){return t.choseType("barter")}}},[t._v("换货")]):t._e(),t._v(" "),5!=t.order_type?o("span",{class:"refunds"==t.ischose?"text_active":"",on:{click:function(e){return t.choseType("refunds")}}},[t._v("仅退款")]):t._e()]),t._v(" "),o("i",{staticClass:"iconfont icon-jinggao type_tips"}),t._v(" "),"refunds"==t.ischose?o("span",{staticClass:"type_tips"},[t._v("此项仅在未收到货，或卖家协商同意前提下进行")]):t._e(),t._v(" "),"reship"==t.ischose?o("span",{staticClass:"type_tips"},[t._v("此项仅在已收到货，需要退换已收到的货物的情况下进行")]):t._e(),t._v(" "),"barter"==t.ischose?o("span",{staticClass:"type_tips"},[t._v("此项仅在商品存在质量问题，联系卖家协商换货的情况下进行")]):t._e()]),t._v(" "),o("div",{staticClass:"after_pro"},[o("div",{staticClass:"car_pro"},[o("div",{staticClass:"pro_img"},[null!=t.orderInfo.img&&""!=t.orderInfo.img?o("img",{attrs:{src:t.orderInfo.img}}):o("img",{attrs:{src:t.imgPath+"pro/static.png"}})]),t._v(" "),o("div",{staticClass:"pro_info"},[o("div",{staticClass:"pro_title"},[o("span",[t._v(t._s(t.orderInfo.name))])]),t._v(" "),o("div",{staticClass:"pro_spec"},[o("div",{staticClass:"pro_price"},[""!=t.orderInfo.title&&null!=t.orderInfo.title?o("div",{staticClass:"spec_info"},[t._v("规格:"+t._s(t.orderInfo.title))]):t._e(),t._v(" "),o("div",{staticStyle:{display:"flex","align-items":"center"}},[t.orderInfo.point>0?o("div",{staticClass:"pro_inter_img"},[o("i",{staticClass:"iconfont icon-jifen1"})]):t._e(),t._v(" "),t.orderInfo.point>0?o("span",{staticClass:"pro_integral"},[t._v(t._s(t.orderInfo.point))]):t._e(),t._v(" "),t.orderInfo.point>0&&t.orderInfo.price>0?o("span",{staticClass:"pro_integral"},[t._v("+")]):t._e(),t._v(" "),t.orderInfo.price>0?o("span",{staticClass:"peo_nowprice"},[t._v("￥"+t._s(t.orderInfo.price))]):t._e()])])])])])]),t._v(" "),o("div",{staticClass:"after_com"},[o("textarea",{directives:[{name:"model",rawName:"v-model",value:t.procomm,expression:"procomm"}],attrs:{"auto-height":"",placeholder:"请您在此描述您的问题,尽可能详细（大于10个字），通过的概率会更大",maxlength:"-1","placeholder-class":"phcolor"},domProps:{value:t.procomm},on:{input:function(e){e.target.composing||(t.procomm=e.target.value)}}}),t._v(" "),o("div",{staticClass:"com_imgList"},[t._l(t.imgs,function(e,s){return o("div",{key:s,staticClass:"imgBlock"},[o("i",{staticClass:"iconfont icon-to-remove",on:{click:function(e){return t.delImg(s)}}}),t._v(" "),o("span"),t._v(" "),o("img",{attrs:{src:e},on:{click:function(o){return t.previewImg(e)}}})])}),t._v(" "),o("div",{staticClass:"hidden_input",on:{click:t.showUpload}},[o("i",{staticClass:"iconfont icon-addpictures addicon",attrs:{hidden:5==t.imgs.length}})])],2)]),t._v(" "),o("div",{staticClass:"after_tips"},[t._v("\n        提交服务单后，售后专员可能会和您电话联系，请保持电话畅通\n      ")]),t._v(" "),"refunds"!=t.ischose&&t.flag>=2?o("div",{staticClass:"after_tracking"},[o("span",[t._v("快递公司：")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.track_name,expression:"track_name"}],attrs:{placeholder:"请输入快递公司","placeholder-class":"trackText"},domProps:{value:t.track_name},on:{input:function(e){e.target.composing||(t.track_name=e.target.value)}}})]):t._e(),t._v(" "),"refunds"!=t.ischose&&t.flag>=2?o("div",{staticClass:"after_tracking"},[o("span",[t._v("快递单号：")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.track_number,expression:"track_number"}],attrs:{placeholder:"请输入物流单号",type:"number","placeholder-class":"trackText"},domProps:{value:t.track_number},on:{input:function(e){e.target.composing||(t.track_number=e.target.value)}}})]):t._e(),t._v(" "),o("div",{staticClass:"comBtn"},[0==t.orderInfo.flag||-1==t.orderInfo.flag?o("mt-button",{attrs:{size:"normal"},on:{click:function(e){return t.saveAfter(t.orderInfo.goods_id,t.orderInfo.product_id)}}},[t._v("提交")]):o("mt-button",{attrs:{size:"normal"},on:{click:function(e){return t.saveAfter(t.orderInfo.goods_id,t.orderInfo.product_id)}}},[t._v("提交修改")])],1)]),t._v(" "),t.imgShow?o("div",{staticClass:"pro_com_img_bg",attrs:{catchtouchmove:"ture"},on:{click:t.hiddenImg}}):t._e(),t._v(" "),t.imgShow?o("div",{staticClass:"pro_com_img",attrs:{catchtouchmove:"ture"},on:{click:t.hiddenImg}},[o("img",{attrs:{src:t.img_show_big,alt:""},on:{click:t.hiddenImg}})]):t._e(),t._v(" "),o("div",{staticClass:"avatar_model_bg",attrs:{hidden:t.hiddenUploadImg},on:{click:t.hiddenModel}}),t._v(" "),o("div",{staticClass:"avatar_model",attrs:{hidden:t.hiddenUploadImg}},[t._m(1),t._v(" "),o("div",{staticClass:"avatar_info",on:{click:t.addImg}},[o("input",{attrs:{type:"file",accept:"image/*",id:"album",name:"pic"}}),t._v(" "),o("img",{attrs:{src:t.imgPath+"com/cra.png"}}),t._v(" "),o("span",[t._v("相册")])]),t._v(" "),o("div",{staticClass:"avatar_info",on:{click:t.choseCra}},[o("img",{attrs:{src:t.imgPath+"com/cra1.png"}}),t._v(" "),o("span",[t._v("拍照")])])]),t._v(" "),t.showToast?o("div",{staticClass:"toast_model"}):t._e()],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"after_head"},[e("span",[this._v("本次售后服务由")]),this._v(" "),e("span",{staticClass:"name"},[this._v("公主购")]),this._v("为您提供\n      ")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"avatar_title"},[e("span",[this._v("上传图片")])])}]};var m=o("VU/8")(d,u,!1,function(t){o("IVfy")},"data-v-eda7fff8",null);e.default=m.exports},fBQ2:function(t,e,o){"use strict";var s=o("evD5"),i=o("X8DO");t.exports=function(t,e,o){e in t?s.f(t,e,i(0,o)):t[e]=o}},qyJz:function(t,e,o){"use strict";var s=o("+ZMJ"),i=o("kM2E"),a=o("sB3e"),n=o("msXi"),r=o("Mhyx"),c=o("QRG4"),l=o("fBQ2"),d=o("3fs2");i(i.S+i.F*!o("dY0y")(function(t){Array.from(t)}),"Array",{from:function(t){var e,o,i,u,m=a(t),p="function"==typeof this?this:Array,_=arguments.length,f=_>1?arguments[1]:void 0,g=void 0!==f,h=0,v=d(m);if(g&&(f=s(f,_>2?arguments[2]:void 0,2)),void 0==v||p==Array&&r(v))for(o=new p(e=c(m.length));e>h;h++)l(o,h,g?f(m[h],h):m[h]);else for(u=v.call(m),o=new p;!(i=u.next()).done;h++)l(o,h,g?n(u,f,[i.value,h],!0):i.value);return o.length=h,o}})}});
//# sourceMappingURL=1.86cba9a98c9b23db4dc0.js.map