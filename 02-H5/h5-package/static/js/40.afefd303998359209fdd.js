webpackJsonp([40],{"7yq3":function(t,o,e){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n=e("Dd8w"),a=e.n(n),i=e("fqE/"),s=e("mtWM"),l=e.n(s),c=e("Au9i"),r=e("gyMJ"),d=e("NYxO"),u=e("WVZN"),f={name:"PersonCenter",components:{commonHeader:i.a,InfiniteScroll:c.InfiniteScroll,Indicator:c.Indicator,Button:c.Button,Lazyload:c.Lazyload,Spinner:c.Spinner,Toast:c.Toast},data:function(){return{imgPath:"https://share.gongzhugou.com/static/image/xcx_img/",avatarUrl:"https://share.gongzhugou.com/static/image/xcx_img/com/pc_avatar.png",hiddenavatar:!0,personInfo:[],h_title:"个人信息",aweixin:""}},mounted:function(){c.Indicator.open("加载中...");var t=window.localStorage;!0!==t.getItem("isLogin")&&"true"!==t.getItem("isLogin")||this.getInfo();var o=this;window.plus.oauth.getServices(function(t){var e=t;console.log(e),"weixin"===t[0].id&&(o.aweixin=t[0])},function(t){console.log("获取分享服务列表失败："+t.message+" - "+t.code)})},methods:a()({},Object(d.c)({setIsbind:"SET_ISBIND",setUserInfo:"SET_USERINFO"}),{exit:function(){if(window.plus){console.log("app端"),this.aweixin.logout(function(t){console.log("注销登录认证成功！")},function(t){console.log(t),console.log("注销登录认证失败！")});var t=window.localStorage;t.clear(),console.log(t),t.setItem("token",null),t.setItem("isLogin",!1),console.log(t),console.log("开始清空vuex"),console.log("重置页面"),this.$router.replace({path:"/member"}),t.setItem("routeLeft","true"),t.setItem("routeRight","false"),t.setItem("showGuide",1),t.setItem("noUpdate",1),t.setItem("bindCid",null),window.location.reload()}else{console.log("浏览器端");var o=window.localStorage;o.clear(),console.log(o),o.setItem("token",null),o.setItem("isLogin",!1),o.setItem("routeLeft","true"),o.setItem("routeRight","false"),o.setItem("showGuide",1),o.setItem("bindCid",null),console.log(o);var e=document.cookie.match(/[^ =;]+(?=\=)/g);if(e)for(var n=e.length;n--;)document.cookie=e[n]+"=0;expires="+new Date(0).toUTCString();console.log("开始清空vuex"),console.log("重置页面"),this.$router.replace({path:"/member"}),window.location.reload()}},editavatat:function(){this.hiddenavatar=!this.hiddenavatar},edit:function(t,o,e){console.log(t),"birthday"===t?null==this.personInfo.birthday&&this.$router.togo({path:o+"&sex="+this.personInfo.sex+"&birthday="+this.personInfo.birthday}):(""!==e&&(o+=e),console.log(o),this.$router.togo({path:o}))},choseAlbum:function(){console.log("选择相册");var t=this;document.getElementById("album").onchange=function(o){console.log(o);var e=o.target.files[0];console.log(e),e.size>5242880?Object(c.Toast)({message:"头像大小不能大于5MB！",duration:1e3}):t.uploadImg(e)}},choseCra:function(){var t=this;console.log("选择拍照");var o=window.plus,e=o.camera.getCamera(),n=e.supportedImageResolutions[0],a=e.supportedImageFormats[0];console.log("Resolution: "+n+", Format: "+a),console.log(e),e.captureImage(function(e){console.log(e),o.io.resolveLocalFileSystemURL(e,function(e){var n="_doc/upload/"+e.name;o.zip.compressImage({src:e.toLocalURL(),dst:n,quality:40,overwrite:!0},function(e){console.log(e),o.io.resolveLocalFileSystemURL(e.target,function(e){console.log(e),e.file(function(e){if(console.log(e),e.size>657920)Object(c.Toast)({message:"头像必须小于5MB！",duration:1e3});else{var n=new o.io.FileReader;n.readAsDataURL(e),n.onloadend=function(o){var n=t.dataURLtoBlob(o.target.result.toString());n.name=e.name,console.log(n),t.uploadImg(n)}}})})},function(t){console.log("压缩图片失败，请稍候再试")})},function(t){console.log("读取拍照文件错误："+t.message)})},function(t){console.log("Capture image failed: "+t.message)},{resolution:n,format:a})},dataURLtoBlob:function(t){for(var o=t.split(","),e=o[0].match(/:(.*?);/)[1],n=atob(o[1].replace(/\s/g,"")),a=n.length,i=new Uint8Array(a);a--;)i[a]=n.charCodeAt(a);return new Blob([i],{type:e})},uploadImg:function(t){console.log(t);var o=this;c.Indicator.open("上传中...");var e=new FormData;e.append("file",t,t.name);var n="?m=myinfo&a=head_portrait";n="https://share.gongzhugou.com/"+n,console.log("请求上传接口啦"),l.a.post(n,e,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}).then(function(t){console.log(t),c.Indicator.close(),t.data.isSuccess&&o.getInfo()}).catch(function(t){c.Indicator.close(),console(t)})},hiddenModel:function(){this.hiddenavatar=!0},getInfo:function(){var t=this;Object(r._9)().then(function(o){if(c.Indicator.close(),o.isSuccess){console.log(o.data.birthday),null!=o.data.birthday&&(o.data.birthday=Object(u.c)(1e3*parseInt(o.data.birthday),"{y}-{m}-{d}")),console.log(o.data.birthday),t.personInfo=o.data,t.hiddenavatar=!0;var e={};console.log(t.personInfo),-1===t.personInfo.image.indexOf("http")?e.avatar="https://share.gongzhugou.com/"+t.personInfo.image:e.avatar=t.personInfo.image,e.level=t.personInfo.rankName,e.isShow=1,e.nickname=o.data.nickname,e.isbind=o.data.bindPhone,e.level_id=o.data.level_id,e.level_name=o.data.levelName,e.inviter=o.data.inviter,e.is_first=o.data.is_first,""!==t.personInfo.mobile&&null!=t.personInfo.mobile&&t.setIsbind(!0),t.setUserInfo(e)}})}}),computed:a()({},Object(d.b)(["number","carnum","isbind","score","news","newsnum","issign"]))},v={render:function(){var t=this,o=t.$createElement,e=t._self._c||o;return e("div",[e("common-header",{attrs:{h_title:t.h_title,showback:!0}}),t._v(" "),e("div",{staticStyle:{height:"0.9rem"},attrs:{id:"person"}}),t._v(" "),e("div",{staticClass:"p_center"},[e("div",{staticClass:"pc_body"},[e("div",{staticClass:"pc_info"},[e("span",{staticClass:"info_title"},[t._v("头像")]),t._v(" "),e("div",{staticClass:"info_more",on:{click:t.editavatat}},[e("img",{staticClass:"pc_avatar",attrs:{src:t.personInfo.image}}),t._v(" "),e("i",{staticClass:"iconfont icon-youjiantou1"})])]),t._v(" "),e("div",{staticClass:"pc_info"},[e("span",{staticClass:"info_title"},[t._v("昵称")]),t._v(" "),e("div",{staticClass:"info_more",on:{click:function(o){return t.edit("nickname","/editInfo?code=nickname&codename=修改昵称&isInput=0&value=",t.personInfo.nickname)}}},[e("span",[t._v(t._s(null==t.personInfo.nickname?"":t.personInfo.nickname))]),t._v(" "),e("i",{staticClass:"iconfont icon-youjiantou1"})])]),t._v(" "),e("div",{staticClass:"pc_info"},[e("span",{staticClass:"info_title"},[t._v("性别")]),t._v(" "),e("div",{staticClass:"info_more"},[e("span",[t._v(t._s(null==t.personInfo.sex?"":"male"==t.personInfo.sex?"男":"女"))])])]),t._v(" "),e("div",{staticClass:"pc_info"},[e("span",{staticClass:"info_title"},[t._v("生日")]),t._v(" "),e("div",{staticClass:"info_more",on:{click:function(o){return t.edit("birthday","/improveInfo?visit=1","")}}},[e("span",[t._v(t._s(null!=t.personInfo.birthday?t.personInfo.birthday:""))]),t._v(" "),null==t.personInfo.birthday?e("i",{staticClass:"iconfont icon-youjiantou1"}):t._e()])]),t._v(" "),e("div",{staticClass:"pc_info"},[e("span",{staticClass:"info_title"},[t._v("电子邮箱")]),t._v(" "),e("div",{staticClass:"info_more",on:{click:function(o){return t.edit("email","/editInfo?code=email&codename=修改电子邮箱&isInput=0&value=",t.personInfo.email)}}},[e("span",[t._v(t._s(null==t.personInfo.email?"":t.personInfo.email))]),t._v(" "),e("i",{staticClass:"iconfont icon-youjiantou1"})])]),t._v(" "),e("div",{staticClass:"pc_info"},[e("span",{staticClass:"info_title"},[t._v("收货地址")]),t._v(" "),e("div",{staticClass:"info_more",on:{click:function(o){return t.edit("address","/editInfo?code=address&codename=我的地址&isInput=1","")}}},[e("span",[t._v(t._s(null==t.personInfo.ship_area?"":t.personInfo.ship_area)+t._s(null==t.personInfo.ship_addr?"":t.personInfo.ship_addr))]),t._v(" "),e("i",{staticClass:"iconfont icon-youjiantou1"})])]),t._v(" "),e("div",{staticClass:"pc_info"},[e("span",{staticClass:"info_title"},[t._v("绑定手机")]),t._v(" "),e("div",{staticClass:"info_more",on:{click:function(o){return t.edit("tel","/bind?code=tel&visit=1","")}}},[e("span",[t._v(t._s(null==t.personInfo.mobile?"":t.personInfo.mobile))]),t._v(" "),e("i",{staticClass:"iconfont icon-youjiantou1"})])]),t._v(" "),e("div",{staticClass:"pc_info"},[e("span",{staticClass:"info_title"},[t._v("我的关注")]),t._v(" "),e("div",{staticClass:"info_attList",on:{click:function(o){return t.edit("myIntersted","/myIntersted?visit=1","")}}},[e("div",{staticClass:"info_att"},t._l(t.personInfo.tag_list,function(o,n){return e("span",{directives:[{name:"show",rawName:"v-show",value:""!=t.personInfo.tag_ids,expression:"personInfo.tag_ids!=''"}],key:n},[t._v(t._s(o.name))])}),0),t._v(" "),e("i",{staticClass:"iconfont icon-youjiantou1"})])])]),t._v(" "),e("div",{staticClass:"exit_btn"},[e("mt-button",{attrs:{"form-type":"submit",size:"normal"},on:{click:t.exit}},[t._v("注销登录")])],1),t._v(" "),e("div",{staticClass:"avatar_model_bg",attrs:{hidden:t.hiddenavatar},on:{click:t.hiddenModel}}),t._v(" "),e("div",{staticClass:"avatar_model",attrs:{hidden:t.hiddenavatar}},[t._m(0),t._v(" "),e("div",{staticClass:"avatar_info",on:{click:t.choseAlbum}},[e("input",{attrs:{type:"file",accept:"image/*",id:"album",name:"pic"}}),t._v(" "),e("img",{attrs:{src:t.imgPath+"com/cra.png"}}),t._v(" "),e("span",[t._v("相册")])]),t._v(" "),e("div",{staticClass:"avatar_info",on:{click:t.choseCra}},[e("img",{attrs:{src:t.imgPath+"com/cra1.png"}}),t._v(" "),e("span",[t._v("拍照")])])])])],1)},staticRenderFns:[function(){var t=this.$createElement,o=this._self._c||t;return o("div",{staticClass:"avatar_title"},[o("span",[this._v("修改头像")])])}]};var m=e("VU/8")(f,v,!1,function(t){e("dxGU")},"data-v-6a4ea54c",null);o.default=m.exports},dxGU:function(t,o){}});
//# sourceMappingURL=40.afefd303998359209fdd.js.map