webpackJsonp([55],{"4soQ":function(e,t){},SQzM:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o("Dd8w"),c=o.n(s),i=o("fqE/"),d=o("Au9i"),u=o("gyMJ"),a=o("NYxO"),n=o("WVZN"),h={name:"name",components:{commonHeader:i.a,InfiniteScroll:d.InfiniteScroll,Indicator:d.Indicator,Button:d.Button,Lazyload:d.Lazyload,Toast:d.Toast},data:function(){return{imgPath:"https://share.gongzhugou.com/static/image/xcx_img/",h_title:"使用优惠券",couList:[],couUseList:[],couNoList:[],staticAdd:[],couValue:0,choseId:0,cou_id:0,choseType:0,isChecked:!1,pid:"",couCode:"",default_code:"",default_cou:"",ship_id:"",addType:"",orderType:"",chooseAdd:"",couRevise:"",addRevise:""}},mounted:function(){var e=this.$route.query,t=this.$store.state.home.choseAddr;this.default_cou=t.default_cou,this.ship_id=t.ship_id,this.addType=t.addType,this.orderType=t.orderType,this.staticAdd=t.staticAdd,this.chooseAdd=t.chooseAdd,this.couInfo=t.couInfo,this.couCode=t.couCode,this.couRevise=t.couisrevise,this.addRevise=t.addisRevise,this.pid=e.pid;var o=t.couList;console.log(o);for(var s=0;s<o.length;s++)-1===o[s].totime.indexOf("-")&&(o[s].totime=Object(n.c)(o[s].totime,"{y}-{m}-{d}")),void 0===o[s].checked||"true"!==o[s].checked&&!0!==o[s].checked?o[s].checked=!1:(this.default_code=o[s].code,this.couValue=o[s].cashworth,this.isChecked=!0,this.choseId=o[s].code,this.cou_id=o[s].id,o[s].checked=!0);for(var c=[],i=[],d=0;d<o.length;d++)o[d].can_use?c.push(o[d]):i.push(o[d]);this.couList=c,this.couUseList=c,this.couNoList=i,this.pid=e.pid},methods:c()({},Object(a.c)({setChoseAddr:"SET_CHOSEADDR",setUserInfo:"SET_USERINFO"}),{goTop:function(){console.log("回到顶部"),document.getElementById("coll").scrollIntoView({block:"start",behavior:"smooth"})},choseTypeList:function(e){this.couList=0===e?this.couUseList:this.couNoList,this.choseType=e},choseCou:function(e){var t=this;if(e.checked=!e.checked,console.log(e),e.checked){for(var o=0;o<this.couList.length;o++)this.couList[o].checked=!1,this.couList[o].id===e.id&&(this.couList[o].checked=!0,this.couValue=this.couList[o].cashworth,this.isChecked=!0,this.choseId=this.couList[o].code);this.cou_id=e.id,this.default_code=e.code,this.$forceUpdate(function(){t.couUseList=t.couList})}else{for(var s=0;s<this.couList.length;s++)this.couList[s].checked=!1,this.couList[s].id===e.id&&(this.couList[s].checked=!1,this.couValue=0,this.isChecked=!1);this.choseId="",this.cou_id="",this.default_code="",this.$forceUpdate(function(){t.couUseList=t.couList})}console.log(this.couUseList)},useCou:function(){var e=this,t="";if(e.staticAdd.length>0&&(t=e.staticAdd[0].id),""===e.choseId){-1!==e.default_cou.indexOf("c=")&&(e.default_cou=e.default_cou.substring(2));var o={coupon_id:e.cou_id,coupon_code:e.default_cou,checked:e.pid,cart_type:e.addType,shipmethod_id:e.ship_id,type:e.orderType,address_id:t};Object(u.j)(o).then(function(t){if(t.isSuccess){var o={couisrevise:!1,chooseAdd:"",couInfo:"",couValue:"",couCode:"",amount:"",couList:[],static_freight:"",staticAdd:[]};e.setChoseAddr(o),o.amount=t.amount;var s="";s=""===e.choseId?"选择优惠券":"已减"+parseInt(t.coupon_discount)+"元",void 0!==t.amount?o.amount=t.amount:o.amount=e.amount,o.couInfo=s,o.couisrevise=!0,o.addisRevise=e.addRevise,o.chooseAdd=e.chooseAdd,o.staticAdd=e.staticAdd,o.couValue=t.coupon_discount,o.couCode=t.cart_params,o.couId=t.coupon_id,o.couList=e.couList.concat(e.couNoList),o.static_freight=t.cost_freight,console.log(o.couList),e.setChoseAddr(o),window.localStorage.setItem("neworder",!1),e.$router.go(-1)}})}else{var s={coupon_id:e.cou_id,coupon_code:e.choseId,checked:e.pid,shipmethod_id:e.ship_id,cart_type:e.addType,type:e.orderType,address_id:t};Object(u._7)(s).then(function(t){if(t.isSuccess){var o={couisrevise:!1,chooseAdd:"",couInfo:"",couValue:"",couCode:"",amount:"",couList:[],static_freight:"",staticAdd:[]};e.setChoseAddr(o),o.amount=t.amount;var s="";s=""===e.choseId?"选择优惠券":"已减"+parseInt(t.coupon_discount)+"元",void 0!==t.amount?o.amount=t.amount:o.amount=e.amount,o.couInfo=s,o.couisrevise=!0,o.addisRevise=e.addRevise,o.chooseAdd=e.chooseAdd,o.staticAdd=e.staticAdd,o.couValue=t.coupon_discount,o.couCode=t.cart_params,o.couId=t.coupon_id,o.couList=e.couList.concat(e.couNoList),console.log(o.couList),o.static_freight=t.cost_freight,e.setChoseAddr(o),window.localStorage.setItem("neworder",!1),e.$router.go(-1)}})}}}),computed:c()({},Object(a.b)([]))},r={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("common-header",{attrs:{h_title:e.h_title,showback:!0}}),e._v(" "),o("return-top",{on:{returnTop:e.goTop}}),e._v(" "),o("div",{staticStyle:{height:"0.9rem"}}),e._v(" "),o("div",{staticClass:"use_coupon"},[o("div",{staticClass:"coupon_body"},[o("div",{staticClass:"coupon_nav"},[o("span",{class:0==e.choseType?"text_active":"",attrs:{id:"0"},on:{click:function(t){return e.choseTypeList(0)}}},[e._v("可用优惠券("+e._s(e.couUseList.length)+")")]),e._v(" "),o("span",{class:1==e.choseType?"text_active":"",attrs:{id:"1"},on:{click:function(t){return e.choseTypeList(1)}}},[e._v("不可使用优惠券("+e._s(e.couNoList.length)+")")])]),e._v(" "),e.isChecked?o("div",{staticClass:"cou_tip"},[e._v("\n        使用优惠券1张，共抵用\n        "),o("span",[e._v("￥"+e._s(e.couValue))])]):e._e(),e._v(" "),o("div",{staticClass:"cou_list"},e._l(e.couList,function(t,s){return o("div",{key:s,staticClass:"cou_info"},[0==e.choseType?o("img",{attrs:{src:e.imgPath+"order/cop_bg.png"}}):e._e(),e._v(" "),1==e.choseType?o("img",{attrs:{src:e.imgPath+"order/cop_bg_01.png"}}):e._e(),e._v(" "),o("div",{staticClass:"cou_more"},[o("div",{staticClass:"cou_value"},[e._v("￥\n              "),o("span",[e._v(e._s(t.cashworth))])]),e._v(" "),o("div",{staticClass:"cou_more_tips"},[t.order_price>0?o("span",[e._v("满"+e._s(t.order_price)+"可用")]):o("span",[e._v("零门槛使用")])])]),e._v(" "),o("div",{staticClass:"cou_tips"},[o("span",{staticClass:"cou_title"},[e._v(e._s(t.title))]),e._v(" "),o("div",{staticClass:"cou_time"},[e._v("有效期至"+e._s(t.totime))]),e._v(" "),null!=t.name?o("span",{staticClass:"cou_type"},[e._v("适用于"+e._s(t.name)+e._s(t.content))]):e._e(),e._v(" "),null==t.name?o("span",{staticClass:"cou_type"},[e._v("全类目通用"+e._s(t.content))]):e._e()]),e._v(" "),o("div",{staticClass:"cou_radio",attrs:{hidden:1==e.choseType}},[o("input",{directives:[{name:"model",rawName:"v-model",value:t.checked,expression:"item.checked"}],attrs:{id:t.id,type:"checkbox"},domProps:{checked:t.checked,checked:Array.isArray(t.checked)?e._i(t.checked,null)>-1:t.checked},on:{click:function(o){return e.choseCou(t)},change:function(o){var s=t.checked,c=o.target,i=!!c.checked;if(Array.isArray(s)){var d=e._i(s,null);c.checked?d<0&&e.$set(t,"checked",s.concat([null])):d>-1&&e.$set(t,"checked",s.slice(0,d).concat(s.slice(d+1)))}else e.$set(t,"checked",i)}}}),e._v(" "),o("label",{attrs:{for:t.id}})])])}),0)]),e._v(" "),o("div",{staticClass:"null_view"}),e._v(" "),0==e.choseType?o("div",{staticClass:"cou_btn",on:{click:e.useCou}},[o("mt-button",{attrs:{size:"normal"}},[e._v("确定")])],1):e._e()])],1)},staticRenderFns:[]};var _=o("VU/8")(h,r,!1,function(e){o("4soQ")},"data-v-369c2373",null);t.default=_.exports}});
//# sourceMappingURL=55.2b4c5fa8038ff5af54bf.js.map