webpackJsonp([41],{"7yq3":function(t,o,n){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var e=n("Dd8w"),a=n.n(e),i=n("fqE/"),s=n("mtWM"),l=n.n(s),c=n("Au9i"),r=n("gyMJ"),d=n("NYxO"),u=n("WVZN"),f={components:{commonHeader:i.a,InfiniteScroll:c.InfiniteScroll,Indicator:c.Indicator,Button:c.Button,Lazyload:c.Lazyload,Spinner:c.Spinner,Toast:c.Toast},data:function(){return{imgPath:"https://share.gongzhugou.com/static/image/xcx_img/",avatarUrl:"https://share.gongzhugou.com/static/image/xcx_img/com/pc_avatar.png",hiddenavatar:!0,personInfo:[],h_title:"个人中心",aweixin:""}},mounted:function(){c.Indicator.open("加载中...");var t=window.localStorage;!0!==t.getItem("isLogin")&&"true"!==t.getItem("isLogin")||this.getInfo();var o=this;window.plus.oauth.getServices(function(t){var n=t;console.log(n),"weixin"===t[0].id&&(o.aweixin=t[0])},function(t){console.log("获取分享服务列表失败："+t.message+" - "+t.code)})},methods:a()({},Object(d.c)({setIsbind:"SET_ISBIND",setUserInfo:"SET_USERINFO"}),{exit:function(){if(window.plus){console.log("app端"),this.aweixin.logout(function(t){console.log("注销登录认证成功！")},function(t){console.log(t),console.log("注销登录认证失败！")});var t=window.localStorage;t.clear(),console.log(t),t.setItem("token",null),t.setItem("isLogin",!1),console.log(t),console.log("开始清空vuex"),console.log("重置页面"),this.$router.replace({path:"/member"}),t.setItem("routeLeft","true"),t.setItem("routeRight","false"),t.setItem("showGuide",1),window.location.reload()}else{console.log("浏览器端");var o=window.localStorage;o.clear(),console.log(o),o.setItem("token",null),o.setItem("isLogin",!1),o.setItem("routeLeft","true"),o.setItem("routeRight","false"),o.setItem("showGuide",1),console.log(o);var n=document.cookie.match(/[^ =;]+(?=\=)/g);if(n)for(var e=n.length;e--;)document.cookie=n[e]+"=0;expires="+new Date(0).toUTCString();console.log("开始清空vuex"),console.log("重置页面"),this.$router.replace({path:"/member"}),window.location.reload()}},editavatat:function(){this.hiddenavatar=!this.hiddenavatar},edit:function(t,o,n){console.log(t),"birthday"===t?null==this.personInfo.birthday&&this.$router.togo({path:o+"&sex="+this.personInfo.sex+"&birthday="+this.personInfo.birthday}):(""!==n&&(o+=n),console.log(o),this.$router.togo({path:o}))},choseAlbum:function(){console.log("选择相册");var t=this;document.getElementById("album").onchange=function(o){var n=o.target.files[0];console.log(n),n.size>5242880?Object(c.Toast)({message:"头像大小不能大于5MB！",duration:1e3}):t.uploadImg(n)}},choseCra:function(){var t=this;console.log("选择拍照");var o=window.plus,n=o.camera.getCamera(),e=n.supportedImageResolutions[0],a=n.supportedImageFormats[0];console.log("Resolution: "+e+", Format: "+a),console.log(n),n.captureImage(function(n){console.log(n),o.io.resolveLocalFileSystemURL(n,function(n){var e="_doc/upload/"+n.name;o.zip.compressImage({src:n.toLocalURL(),dst:e,quality:40,overwrite:!0},function(n){console.log(n),o.io.resolveLocalFileSystemURL(n.target,function(n){console.log(n),n.file(function(n){if(console.log(n),n.size>657920)Object(c.Toast)({message:"头像必须小于5MB！",duration:1e3});else{var e=new o.io.FileReader;e.readAsDataURL(n),e.onloadend=function(o){var e=t.dataURLtoBlob(o.target.result.toString());e.name=n.name,console.log(e),t.uploadImg(e)}}})})},function(t){console.log("压缩图片失败，请稍候再试")})},function(t){console.log("读取拍照文件错误："+t.message)})},function(t){console.log("Capture image failed: "+t.message)},{resolution:e,format:a})},dataURLtoBlob:function(t){for(var o=t.split(","),n=o[0].match(/:(.*?);/)[1],e=atob(o[1].replace(/\s/g,"")),a=e.length,i=new Uint8Array(a);a--;)i[a]=e.charCodeAt(a);return new Blob([i],{type:n})},uploadImg:function(t){console.log(t);var o=this,n=new FormData;n.append("file",t,t.name);var e="?m=myinfo&a=head_portrait";e="https://share.gongzhugou.com/"+e,console.log("请求上传接口啦"),l.a.post(e,n,{headers:{"Content-Type":"multipart/form-data"},withCredentials:!0}).then(function(t){console.log(t),t.data.isSuccess&&o.getInfo()}).catch(function(t){console(t)})},hiddenModel:function(){this.hiddenavatar=!0},getInfo:function(){var t=this;Object(r._6)().then(function(o){if(c.Indicator.close(),o.isSuccess){console.log(o.data.birthday),null!=o.data.birthday&&(o.data.birthday=Object(u.c)(1e3*parseInt(o.data.birthday),"{y}-{m}-{d}")),console.log(o.data.birthday),t.personInfo=o.data,t.hiddenavatar=!0;var n={};console.log(t.personInfo),-1===t.personInfo.image.indexOf("http")?n.avatar="https://share.gongzhugou.com/"+t.personInfo.image:n.avatar=t.personInfo.image,n.level=t.personInfo.rankName,n.isShow=1,n.nickname=o.data.nickname,n.isbind=o.data.bindPhone,n.level_id=o.data.level_id,n.level_name=o.data.levelName,n.inviter=o.data.inviter,n.is_first=o.data.is_first,""!==t.personInfo.mobile&&null!=t.personInfo.mobile&&t.setIsbind(!0),t.setUserInfo(n)}})}}),computed:a()({},Object(d.b)(["number","carnum","isbind","score","news","newsnum","issign"]))},v={render:function(){var t=this,o=t.$createElement,n=t._self._c||o;return n("div",[n("common-header",{attrs:{h_title:t.h_title,showback:!0}}),t._v(" "),n("div",{staticStyle:{height:"0.9rem"},attrs:{id:"person"}}),t._v(" "),n("div",{staticClass:"p_center"},[n("div",{staticClass:"pc_body"},[n("div",{staticClass:"pc_info"},[n("span",{staticClass:"info_title"},[t._v("头像")]),t._v(" "),n("div",{staticClass:"info_more",on:{click:t.editavatat}},[n("img",{staticClass:"pc_avatar",attrs:{src:t.personInfo.image}}),t._v(" "),n("i",{staticClass:"iconfont icon-youjiantou1"})])]),t._v(" "),n("div",{staticClass:"pc_info"},[n("span",{staticClass:"info_title"},[t._v("昵称")]),t._v(" "),n("div",{staticClass:"info_more",on:{click:function(o){return t.edit("nickname","/editInfo?code=nickname&codename=修改昵称&isInput=0&value=",t.personInfo.nickname)}}},[n("span",[t._v(t._s(null==t.personInfo.nickname?"":t.personInfo.nickname))]),t._v(" "),n("i",{staticClass:"iconfont icon-youjiantou1"})])]),t._v(" "),n("div",{staticClass:"pc_info"},[n("span",{staticClass:"info_title"},[t._v("性别")]),t._v(" "),n("div",{staticClass:"info_more"},[n("span",[t._v(t._s(null==t.personInfo.sex?"":"male"==t.personInfo.sex?"男":"女"))])])]),t._v(" "),n("div",{staticClass:"pc_info"},[n("span",{staticClass:"info_title"},[t._v("生日")]),t._v(" "),n("div",{staticClass:"info_more",on:{click:function(o){return t.edit("birthday","/improveInfo?visit=1","")}}},[n("span",[t._v(t._s(null!=t.personInfo.birthday?t.personInfo.birthday:""))]),t._v(" "),null==t.personInfo.birthday?n("i",{staticClass:"iconfont icon-youjiantou1"}):t._e()])]),t._v(" "),n("div",{staticClass:"pc_info"},[n("span",{staticClass:"info_title"},[t._v("电子邮箱")]),t._v(" "),n("div",{staticClass:"info_more",on:{click:function(o){return t.edit("email","/editInfo?code=email&codename=修改电子邮箱&isInput=0&value=",t.personInfo.email)}}},[n("span",[t._v(t._s(null==t.personInfo.email?"":t.personInfo.email))]),t._v(" "),n("i",{staticClass:"iconfont icon-youjiantou1"})])]),t._v(" "),n("div",{staticClass:"pc_info"},[n("span",{staticClass:"info_title"},[t._v("收货地址")]),t._v(" "),n("div",{staticClass:"info_more",on:{click:function(o){return t.edit("address","/editInfo?code=address&codename=我的地址&isInput=1","")}}},[n("span",[t._v(t._s(null==t.personInfo.ship_area?"":t.personInfo.ship_area)+t._s(null==t.personInfo.ship_addr?"":t.personInfo.ship_addr))]),t._v(" "),n("i",{staticClass:"iconfont icon-youjiantou1"})])]),t._v(" "),n("div",{staticClass:"pc_info"},[n("span",{staticClass:"info_title"},[t._v("绑定手机")]),t._v(" "),n("div",{staticClass:"info_more",on:{click:function(o){return t.edit("tel","/bind?code=tel&visit=1","")}}},[n("span",[t._v(t._s(null==t.personInfo.mobile?"":t.personInfo.mobile))]),t._v(" "),n("i",{staticClass:"iconfont icon-youjiantou1"})])]),t._v(" "),n("div",{staticClass:"pc_info"},[n("span",{staticClass:"info_title"},[t._v("我的关注")]),t._v(" "),n("div",{staticClass:"info_attList",on:{click:function(o){return t.edit("myIntersted","/myIntersted?visit=1","")}}},[n("div",{staticClass:"info_att"},t._l(t.personInfo.tag_list,function(o,e){return n("span",{directives:[{name:"show",rawName:"v-show",value:""!=t.personInfo.tag_ids,expression:"personInfo.tag_ids!=''"}],key:e},[t._v(t._s(o.name))])}),0),t._v(" "),n("i",{staticClass:"iconfont icon-youjiantou1"})])])]),t._v(" "),n("div",{staticClass:"exit_btn"},[n("mt-button",{attrs:{"form-type":"submit",size:"normal"},on:{click:t.exit}},[t._v("注销登录")])],1),t._v(" "),n("div",{staticClass:"avatar_model_bg",attrs:{hidden:t.hiddenavatar},on:{click:t.hiddenModel}}),t._v(" "),n("div",{staticClass:"avatar_model",attrs:{hidden:t.hiddenavatar}},[t._m(0),t._v(" "),n("div",{staticClass:"avatar_info",on:{click:t.choseAlbum}},[n("input",{attrs:{type:"file",accept:"image/*",id:"album",name:"pic"}}),t._v(" "),n("img",{attrs:{src:t.imgPath+"com/cra.png"}}),t._v(" "),n("span",[t._v("相册")])]),t._v(" "),n("div",{staticClass:"avatar_info",on:{click:t.choseCra}},[n("img",{attrs:{src:t.imgPath+"com/cra1.png"}}),t._v(" "),n("span",[t._v("拍照")])])])])],1)},staticRenderFns:[function(){var t=this.$createElement,o=this._self._c||t;return o("div",{staticClass:"avatar_title"},[o("span",[this._v("修改头像")])])}]};var m=n("VU/8")(f,v,!1,function(t){n("SjJH")},"data-v-69a0f866",null);o.default=m.exports},SjJH:function(t,o){}});
//# sourceMappingURL=41.2e4c7626d0a1b440bf62.js.map