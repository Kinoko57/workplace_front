webpackJsonp([52],{"255A":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=i("mvHQ"),s=i.n(o),d=i("Dd8w"),a=i.n(d),c=i("fqE/"),n=i("Au9i"),r=i("gyMJ"),u=i("NYxO"),h={name:"EditInfo",components:{commonHeader:c.a,InfiniteScroll:n.InfiniteScroll,Indicator:n.Indicator,Button:n.Button,Lazyload:n.Lazyload,MessageBox:n.MessageBox,Toast:n.Toast},data:function(){return{formType:"",h_title:"我的优惠券",editcode:"",editInput:0,addrList:[],value:"",chooseAdd:!1,default_code:"",default_cou:"",ship_id:"",addType:"",staticAdd:[],orderType:"",choseId:"",cou_id:0,couCode:"",couList:[],pid:"",amount:0,imgPath:"https://share.gongzhugou.com/static/image/xcx_img/",couRevise:"",addRevise:""}},mounted:function(){var e=this.$route.query;console.log(e);if(this.formType=e.type,"choose"===e.type&&(this.chooseAdd=!0),"address"===e.code){if(void 0!==e.type){var t=this.$store.state.home.choseAddr;console.log(t),this.choseId=t.choseId,this.ship_id=t.ship_id,this.addType=t.addType,this.orderType=t.orderType,this.staticAdd=t.staticAdd,this.pid=e.pid,this.amount=t.amount,this.cou_id=t.couId,this.couList=t.couList,this.couInfo=t.couInfo,this.couCode=t.couCode,this.couRevise=t.couisrevise,this.addRevise=t.addisRevise}}else"nickname"!==e.code&&"email"!==e.code||("null"===e.value||""===e.value?this.value="":this.value=e.value);this.editcode=e.code,this.editInput=e.isInput,this.h_title=e.codename,"address"===this.editcode&&(n.Indicator.open("加载中..."),this.getAddrList())},methods:a()({},Object(u.c)({setChoseAddr:"SET_CHOSEADDR",setUserInfo:"SET_USERINFO"}),{getAddrList:function(){var e=this;Object(r.U)().then(function(t){n.Indicator.close(),t.isSuccess&&(e.addrList=t.rows)})},editAdd:function(e){"choose"==this.formType?this.$router.togo({path:"/editAddr",name:"EditAddr",params:{type:"choose_edit",pid:this.pid,info:e}}):this.$router.togo({path:"/editAddr",name:"EditAddr",params:{type:"edit",info:e}})},newAdd:function(){var e="",t={};"choose"===this.formType?(e="choose",t={coupon_code:this.choseId,checked:this.pid,shipmethod_id:this.ship_id,cart_type:this.addType,type:this.orderType,address_id:""}):e="new",this.$router.togo({path:"/editAddr",name:"EditAddr",params:{type:e,info:t}})},delAdd:function(e,t){if(1==t)Object(n.Toast)({message:"必须保留一条地址哦~",duration:1e3});else{var i=this,o=window.plus;window.plus?o.nativeUI.confirm("是否删除当前地址?",function(t){console.log("Close confirm: "+t.index),0===t.index||"0"===t.index?Object(r.s)(e).then(function(e){e.isSuccess?(Object(n.Toast)({message:"删除成功",iconClass:"iconfont icon-dui1",duration:1e3}),setTimeout(function(){n.Indicator.open("加载中..."),i.addrList=[],i.getAddrList()},1e3)):Object(n.Toast)({message:e.msg,duration:1e3})}):console.log("用户点击取消")},{title:"提示",buttons:["确定","取消"],verticalAlign:"center"}):Object(n.MessageBox)({title:"提示",message:"是否删除当前地址",showCancelButton:!0,closeOnClickModal:!1}).then(function(t){"confirm"===t?Object(r.s)(e).then(function(e){e.isSuccess?(Object(n.Toast)({message:"删除成功",iconClass:"iconfont icon-dui1",duration:1e3}),setTimeout(function(){n.Indicator.open("加载中..."),i.addrList=[],i.getAddrList()},1e3)):Object(n.Toast)({message:e.msg,duration:1e3})}):console.log("用户点击取消")})}},editInfo:function(e){this.value=e},saveInfo:function(){var e=!0;if("email"===this.editcode){/^[a-zA-Z0-9_.-]+@[a-zA-Z0-9-]+(.[a-zA-Z0-9-]+)*.[a-zA-Z0-9]{2,6}$/.test(this.value)||(Object(n.Toast)({message:"请填写正确的邮箱",duration:1e3}),e=!1)}else if("nickname"===this.editcode){/^[\u4e00-\u9fa5_a-zA-Z0-9_]{2,8}$/.test(this.value)||(Object(n.Toast)({message:"请填写正确的用户名",duration:1e3}),e=!1)}var t=this;if(e){var i={};i[t.editcode]=t.value;var o=[];o.push(i),Object(r._37)(s()(o)).then(function(e){if(e.isSuccess){if(Object(n.Toast)({message:"保存成功",iconClass:"iconfont icon-dui1",duration:1e3}),"nickname"===t.editcode){var i=t.$store.state.home.userInfo;i.nickname=t.value,t.setUserInfo(i)}setTimeout(function(){t.$router.go(-1)},1e3)}})}},checkAddr:function(e){for(var t=0,i=this.addrList.length;t<i;t++)this.addrList[t].is_default="0";for(var o={},s=0,d=this.addrList.length;s<d;s++)this.addrList[s].id===e&&(this.addrList[s].is_default="1",o=this.addrList[s]);var a=this,c={id:e,ship_name:o.ship_name,ship_mobile:o.ship_mobile,ship_area:o.ship_area,ship_addr:o.ship_addr,is_default:"1"};Object(r._41)(c).then(function(t){if(t.isSuccess&&(console.log(a.chooseAdd),a.chooseAdd)){var i={coupon_id:a.cou_id,coupon_code:a.choseId,checked:a.pid,shipmethod_id:a.ship_id,cart_type:a.addType,type:a.orderType,address_id:e};console.log(i),Object(r._7)(i).then(function(t){if(t.isSuccess){var i={couId:"",couInfo:"",couValue:"",couCode:"",chooseAdd:"",amount:"",staticAdd:[],static_freight:"",couisrevise:!1,addisRevise:!1};a.setChoseAddr(i),i.amount=t.amount;var s="";s=""===a.choseId?"选择优惠券":"已减"+parseInt(t.coupon_discount)+"元",void 0!==t.amount?i.amount=t.amount:i.amount=a.amount,console.log(o),i.couisrevise=a.couRevise,i.addisRevise=!0,i.couInfo=s,i.couValue=t.coupon_discount,i.couCode=t.cart_params,i.couId=t.coupon_id,i.chooseAdd=e,i.staticAdd.push(o),i.couList=a.couList,i.static_freight=t.cost_freight,a.setChoseAddr(i),console.log("修改默认地址"),window.localStorage.setItem("neworder",!1),a.$router.back()}})}})},choseAdd:function(e){if(this.chooseAdd){for(var t={},i=0,o=this.addrList.length;i<o;i++)this.addrList[i].id===e&&(t=this.addrList[i]);var s=this;console.log(s.choseId);var d={coupon_id:s.cou_id,coupon_code:s.choseId,checked:s.pid,shipmethod_id:s.ship_id,cart_type:s.addType,type:s.orderType,address_id:e};console.log(d),Object(r._7)(d).then(function(i){if(i.isSuccess){var o={couId:"",couInfo:"",couValue:"",amount:"",orderDetail:"",staticAdd:[],static_freight:"",chooseAdd:"",couisrevise:!1,addisRevise:!1};o.amount=i.amount;var d="";d=""===s.choseId?"选择优惠券":"已减"+parseInt(i.coupon_discount)+"元",void 0!==i.amount?o.amount=i.amount:o.amount=s.amount,o.couisrevise=s.couRevise,o.addisRevise=!0,o.chooseAdd=e,o.couInfo=d,o.couValue=i.coupon_discount,o.couCode=i.cart_params,o.couId=i.coupon_id,o.staticAdd.push(t),o.couList=s.couList,o.static_freight=i.cost_freight,s.setChoseAddr(o),window.localStorage.setItem("neworder",!1),console.log("选择更换地址"),s.$router.back()}})}}}),computed:a()({},Object(u.b)([]))},l={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("common-header",{attrs:{h_title:e.h_title,showback:!0}}),e._v(" "),i("div",{staticClass:"editInfo"},[i("div",{staticStyle:{height:"0.9rem"},attrs:{id:"addr"}}),e._v(" "),i("div",{class:0==e.editInput?"e_body":"body_hide"},[i("div",{class:"nickname"==e.editcode?"section":"hide"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],attrs:{placeholder:"请输入昵称",type:"text"},domProps:{value:e.value},on:{blur:function(t){return e.editInfo(e.value)},input:function(t){t.target.composing||(e.value=t.target.value)}}})]),e._v(" "),"nickname"==e.editcode?i("div",{staticClass:"info_tips"},[i("span",[e._v("提示：昵称由2-8位中文，英文字母和数字及下划线组成")])]):e._e(),e._v(" "),i("div",{class:"email"==e.editcode?"section":"hide"},[i("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],attrs:{placeholder:"请输入电子邮箱",type:"text"},domProps:{value:e.value},on:{blur:function(t){return e.editInfo(e.value)},input:function(t){t.target.composing||(e.value=t.target.value)}}})]),e._v(" "),i("div",{staticClass:"section saveInfo"},[i("button",{attrs:{size:"default"},on:{click:e.saveInfo}},[e._v("保存")])])]),e._v(" "),i("div",{class:1==e.editInput?"e_add_body":"body_hide"},[e._l(e.addrList,function(t,o){return i("div",{key:o,staticClass:"add_section"},[i("div",{staticClass:"add_info",on:{click:function(i){e.choseAdd(t.id)}}},[i("div",{staticClass:"info_people"},[i("span",{staticClass:"peop_name"},[e._v(e._s(t.ship_name))]),e._v(" "),i("span",{staticClass:"peop_tel"},[e._v(e._s(t.ship_mobile))])]),e._v(" "),i("div",{staticClass:"info_addr"},[i("span",{staticStyle:{"margin-right":"10/100rem"}},[e._v(e._s(t.ship_area))]),e._v(" "+e._s(t.ship_addr)+"\n          ")])]),e._v(" "),i("div",{staticClass:"add_edit"},[i("div",{staticClass:"edit_radio"},[i("input",{attrs:{id:o,type:"radio"},domProps:{checked:"1"==t.is_default,value:t.id},on:{click:function(i){return e.checkAddr(t.id)}}}),e._v(" "),i("label",{attrs:{for:o}}),e._v(" "),i("span",{class:"1"==t.is_default?"isChecked":""},[e._v("默认地址")])]),e._v(" "),i("div",{staticClass:"operating"},[i("div",{on:{click:function(i){return e.editAdd(t)}}},[i("img",{staticClass:"oper_icon",attrs:{src:e.imgPath+"com/edit.png"}}),e._v(" "),i("span",[e._v("编辑")])]),e._v(" "),i("div",{on:{click:function(i){return e.delAdd(t.id,e.addrList.length)}}},[i("img",{staticClass:"oper_icon",attrs:{src:e.imgPath+"com/del.png"}}),e._v(" "),i("span",[e._v("删除")])])])])])}),e._v(" "),i("div",{staticClass:"null_section"}),e._v(" "),i("div",{staticClass:"add_saveInfo"},[i("mt-button",{attrs:{"form-type":"submit",size:"normal"},on:{click:e.newAdd}},[e._v("+添加新地址")])],1)],2)])],1)},staticRenderFns:[]};var p=i("VU/8")(h,l,!1,function(e){i("snFz")},"data-v-472636cb",null);t.default=p.exports},snFz:function(e,t){}});
//# sourceMappingURL=52.1c4e5b9b2d8c4ce931ee.js.map