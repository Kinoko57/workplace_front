webpackJsonp([36],{PDja:function(e,i){},T4UA:function(e,i,t){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n=t("Td3j"),o=t("Au9i"),s={name:"AddCard",components:{commonHeader:t("fqE/").a,InfiniteScroll:o.InfiniteScroll,Indicator:o.Indicator,Lazyload:o.Lazyload,Button:o.Button,Field:o.Field,Picker:o.Picker,Switch:o.Switch,Popup:o.Popup,Toast:o.Toast},data:function(){return{height:"",h_title:"添加银行卡",head_color:{background:"#ffffff",color:"#000000"},bankChose:"请选择所属银行",bankChange:!1,myBankSlots:[{flex:1,values:[],className:"slot1",textAlign:"center"}],account:"",id_number:"",bind:0,imgPath:"https://share.gongzhugou.com/static/image/xcx_img/",showCkeck:!1,length:6,value:"",ispassword:!1,inputLen:6,timeCode:"",is_cutdown:!1,iptValue:"",isclose:-1,realInfo:{id:"",name:null,bank:null,cardNum:null,phone:null,idNumber:null},userName:"",userCardNum:"",userPhone:"",userIdNumber:"",showBank:!0,bank:[],bankList:[],index:0,indexId:1,form:{name:"",$dirty:!1,$invalidMsg:"",idNumber:"",bank:"",cardNum:"",phone:""},interval:"",bankName:""}},mounted:function(){this.getAddList(),this.getBankBind()},methods:{focus:function(e){var i=e.target.value;this.value=i},tap:function(e){console.log(e),this.$nextTick(function(){this.$refs.inputVal.focus()})},closeCheck:function(){this.showCkeck=!1,this.is_cutdown=!1,this.timeCode=60,this.value="",clearInterval(this.interval)},showBankModel:function(){this.bankChange=!0},hideBank:function(){this.bankChange=!1;1===this.isclose?(this.isclose=1,this.form.$dirty=!1,this.form.$invalidMsg=""):(this.isclose=0,this.form.$dirty=!0,this.form.$invalidMsg="所属银行不能为空")},changeBank:function(){var e=this;e.bankChose=e.bankName,e.bankChange=!1,this.bankList.forEach(function(i,t){e.bankChose===i.short_name&&(console.log(i,t),e.index=t,e.indexId=i.id,e.isclose=1,e.form.$dirty=!1,e.form.$invalidMsg="")})},onBankChange:function(e,i){console.log(e,i,"picker, values"),this.bankName=i[0]},getCode:function(){var e=this,i=60;e.timeCode=i+"秒",clearInterval(e.interval),e.interval=setInterval(function(){e.timeCode=i-1+"秒",--i<=0&&(clearInterval(e.interval),e.is_cutdown=!1)},1e3)},validate:function(e,i){if(this.form.$dirty=!1,this.form.$invalidMsg="","name"===e){""===i||null===i||/^\s+$/gi.test(i)?(this.form.$dirty=!0,this.form.$invalidMsg="姓名不能为空",this.form.name=!0):!1===/^.{2,35}$/.test(i)?(this.form.$dirty=!0,this.form.$invalidMsg="姓名长度为2~35",this.form.name=!0):(this.form.$dirty=!1,this.form.$invalidMsg="",this.form.name=!1)}else if("cardNum"===e){""===i||null===i?(this.form.$dirty=!0,this.form.$invalidMsg="银行卡号不能为空",this.form.cardNum=!0):!1===/^[\d]{16,19}$/.test(i)?(this.form.$dirty=!0,this.form.$invalidMsg="银行卡号格式不正确",this.form.cardNum=!0):(this.form.$dirty=!1,this.form.$invalidMsg="",this.form.cardNum=!1)}else if("idNumber"===e){""===i||null===i?(this.form.$dirty=!0,this.form.$invalidMsg="身份证号不能为空",this.form.idNumber=!0):!1===/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/.test(i)?(this.form.$dirty=!0,this.form.$invalidMsg="身份证号格式不正确",this.form.idNumber=!0):(this.form.$dirty=!1,this.form.$invalidMsg="",this.form.idNumber=!1)}else if("phone"===e){var t=/^[1][0-9]{10}$/;""===i||null===i?(this.form.$dirty=!0,this.form.$invalidMsg="手机号码不能为空",this.form.phone=!0):(console.log(t.test(i)),!1===t.test(i)?(this.form.$dirty=!0,this.form.$invalidMsg="手机号码格式不正确",this.form.phone=!0):(this.form.$dirty=!1,this.form.$invalidMsg="",this.form.phone=!1))}else"所属银行不能为空"===this.bankChose?(this.isClose=0,this.form.$dirty=!0,this.form.$invalidMsg="所属银行不能为空"):(this.form.$dirty=!1,this.form.$invalidMsg="",this.isClose=1)},formSubmit:function(e){var i=this;if(console.log(i.realInfo,"111"),console.log(i.isclose,"that.isclose"),0===i.bind){if(!1!==i.form.name)i.validate("name",i.realInfo.name);else if(!1!==i.form.cardNum)i.validate("cardNum",i.realInfo.cardNum);else if(!1!==i.form.idNumber)i.validate("idNumber",i.realInfo.idNumber);else if(!1!==i.form.phone)i.validate("phone",i.realInfo.phone);else if(i.isclose<=0)this.validate("bank",i.bankChose);else if(console.log("全部校验通过"),this.index<0)i.isclose=0;else if(""===this.form.$invalidMsg){i.userName=i.realInfo.name,i.userCardNum=i.realInfo.cardNum,i.userPhone=i.realInfo.phone,i.userIdNumber=i.realInfo.idNumber,o.Indicator.open({text:"提交中...",spinnerType:"fading-circle"});var t={name:i.realInfo.name,card:i.realInfo.cardNum,bank:i.indexId,mobile:i.realInfo.phone,id_number:i.realInfo.idNumber};console.log(i.indexId,"that.indexId"),Object(n.n)(t).then(function(e){console.log(e,"submit"),e.isSuccess?(o.Indicator.close(),i.is_cutdown=!0,i.showCkeck=!0,i.getCode()):"短信动态码验证中"===e.msg?(o.Indicator.close(),i.is_cutdown=!0,i.showCkeck=!0):(o.Indicator.close(),Object(o.Toast)({message:e.msg,duration:2e3}),i.is_cutdown=!1,i.showCkeck=!1)})}}else if(!1!==i.form.phone)i.validate("cardNum",this.realInfo.cardNum);else if(!1!==i.form.phone)i.validate("phone",this.realInfo.phone);else if(console.log("全部校验通过"),i.index<0)i.isclose=0;else if(""===i.form.$invalidMsg){i.userName="",i.userCardNum=i.realInfo.cardNum,i.userPhone=i.realInfo.phone,i.userIdNumber="",o.Indicator.open({text:"提交中...",spinnerType:"fading-circle"});var s={name:i.realInfo.name,card:i.realInfo.cardNum,bank:i.indexId,mobile:i.realInfo.phone,id_number:i.realInfo.idNumber};Object(n.n)(s).then(function(e){console.log(e),e.isSuccess?(o.Indicator.close(),i.is_cutdown=!0,i.showCkeck=!0):"短信动态码验证中"===e.msg?(o.Indicator.close(),i.is_cutdown=!0,i.showCkeck=!0):(o.Indicator.close(),Object(o.Toast)({message:e.msg,duration:2e3}),i.is_cutdown=!1,i.showCkeck=!1)})}},formSubmits:function(e){var i=this,t=this.value;if(""===this.value)i.title="验证码不可以为空",i.duration=2e3,i.icon="none";else{this.closeCheck(),console.log(e,"我是提交信息"),o.Indicator.open({text:"提交中...",spinnerType:"fading-circle"});var s={verify:t};Object(n.m)(s).then(function(e){console.log(e),e.isSuccess?(o.Indicator.close(),Object(o.Toast)({message:e.msg,duration:1e3}),setTimeout(function(){i.$router.goBack()},1e3)):(o.Indicator.close(),Object(o.Toast)({message:e.msg,duration:1e3}))})}},getAddList:function(){var e=this;Object(n.a)().then(function(i){if(console.log(i,"getBankList"),i.isSuccess){var t=[];i.data.bank.forEach(function(e){t.push(e.short_name)}),e.band=t,e.myBankSlots[0].values=t,e.bankList=i.data.bank}})},getBankBind:function(){var e=this;Object(n.l)().then(function(i){var t=e;console.log(i,"is"),i.isSuccess&&(1===i.data.is_added?(t.bind=1,t.account=i.data.bank.account,t.id_number=i.data.bank.id_number,console.log(t.bind)):t.bind=0)})}}},a={render:function(){var e=this,i=e.$createElement,t=e._self._c||i;return t("div",[t("common-header",{attrs:{h_title:e.h_title,showback:!0,bgcolor:e.head_color}}),e._v(" "),t("div",{staticStyle:{height:"0.9rem"}}),e._v(" "),t("div",{staticClass:"realName",style:{height:e.height}},[t("div",{staticClass:"real_body"},[e._m(0),e._v(" "),t("div",{staticClass:"form_body"},[t("div",{staticClass:"section"},[t("span",{staticClass:"form_title text_left"},[e._v("姓名")]),e._v(" "),0==e.bind?t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.realInfo.name,expression:"realInfo.name",modifiers:{trim:!0}}],attrs:{placeholder:"请填写姓名",name:"name",type:"text"},domProps:{value:e.realInfo.name},on:{blur:[function(i){return e.validate("name",e.realInfo.name)},function(i){return e.$forceUpdate()}],input:function(i){i.target.composing||e.$set(e.realInfo,"name",i.target.value.trim())}}}):e._e(),e._v(" "),1==e.bind?t("label",{staticClass:"name"},[t("span",{staticClass:"label-1__text"},[e._v(e._s(e.account))])]):e._e(),e._v(" "),0==e.bind?t("div",{staticStyle:{display:"inline-block",height:"1rem","line-height":"1rem"}},[""!==e.form.name?t("i",{class:1==e.form.name?"iconfont icon-cuowu red":"iconfont icon-succ green"}):e._e()]):e._e()]),e._v(" "),t("div",{staticClass:"section"},[t("span",{staticClass:"form_title text_left"},[e._v("银行卡账号")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.realInfo.cardNum,expression:"realInfo.cardNum",modifiers:{trim:!0}}],attrs:{placeholder:"请输入银行卡账号",name:"cardNum",type:"number"},domProps:{value:e.realInfo.cardNum},on:{blur:[function(i){return e.validate("cardNum",e.realInfo.cardNum)},function(i){return e.$forceUpdate()}],input:function(i){i.target.composing||e.$set(e.realInfo,"cardNum",i.target.value.trim())}}}),e._v(" "),t("div",{staticStyle:{display:"inline-block",height:"1rem","line-height":"1rem"}},[""!==e.form.cardNum?t("i",{class:1==e.form.cardNum?"iconfont icon-cuowu red":"iconfont icon-succ green"}):e._e()])]),e._v(" "),t("div",{staticClass:"section"},[t("span",{staticClass:"form_title text_left"},[e._v("所属银行")]),e._v(" "),t("div",{class:e.isclose<1?"bankChose":"bankChoseCon",staticStyle:{display:"inline-block",width:"4rem"},on:{click:e.showBankModel}},[e._v(e._s(e.bankChose))]),e._v(" "),t("div",{staticStyle:{display:"inline-block"}},[e.isclose>=0?t("i",{class:0==e.isclose?"iconfont icon-cuowu red":"iconfont icon-succ green",attrs:{size:"16"}}):e._e()])]),e._v(" "),t("div",{staticClass:"section"},[t("span",{staticClass:"form_title text_left"},[e._v("身份证号")]),e._v(" "),0==e.bind?t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.realInfo.idNumber,expression:"realInfo.idNumber",modifiers:{trim:!0}}],attrs:{placeholder:"请输入身份证号",name:"idNumber",type:"text"},domProps:{value:e.realInfo.idNumber},on:{blur:[function(i){return e.validate("idNumber",e.realInfo.idNumber)},function(i){return e.$forceUpdate()}],input:function(i){i.target.composing||e.$set(e.realInfo,"idNumber",i.target.value.trim())}}}):e._e(),e._v(" "),1==e.bind?t("label",{staticClass:"name"},[t("span",{staticClass:"label-1__text"},[e._v(e._s(e.id_number))])]):e._e(),e._v(" "),0==e.bind?t("div",{staticStyle:{display:"inline-block",height:"1rem","line-height":"1rem"}},[""!==e.form.idNumber?t("i",{class:1==e.form.idNumber?"iconfont icon-cuowu red":"iconfont icon-succ green"}):e._e()]):e._e()]),e._v(" "),t("div",{staticClass:"section last_section"},[t("span",{staticClass:"form_title text_left"},[e._v("预留手机号")]),e._v(" "),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.realInfo.phone,expression:"realInfo.phone",modifiers:{trim:!0}}],attrs:{placeholder:"请输入开户时预留手机号",name:"phone",type:"number"},domProps:{value:e.realInfo.phone},on:{blur:[function(i){return e.validate("phone",e.realInfo.phone)},function(i){return e.$forceUpdate()}],input:function(i){i.target.composing||e.$set(e.realInfo,"phone",i.target.value.trim())}}}),e._v(" "),t("div",{staticStyle:{display:"inline-block",height:"1rem","line-height":"1rem"}},[""!==e.form.phone?t("i",{class:1==e.form.phone?"iconfont icon-cuowu red":"iconfont icon-succ green"}):e._e()])]),e._v(" "),t("div",{staticClass:"saveInfo"},[t("button",{attrs:{disabled:e.is_cutdown},on:{click:e.formSubmit}},[e._v("提交 "),e.is_cutdown?t("span",[e._v("（"+e._s(e.timeCode)+"）")]):e._e()])])])]),e._v(" "),e.form.$dirty?t("div",{staticClass:"invalid"},[e._v("\n        "+e._s(e.form.$invalidMsg)+"\n      ")]):e._e(),e._v(" "),t("mt-popup",{staticClass:"editArea",attrs:{position:"bottom"},model:{value:e.bankChange,callback:function(i){e.bankChange=i},expression:"bankChange"}},[t("div",{staticClass:"picker_btn"},[t("span",{on:{click:e.hideBank}},[e._v("取消")]),e._v(" "),t("span",{on:{click:e.changeBank}},[e._v("确认")])]),e._v(" "),t("mt-picker",{attrs:{slots:e.myBankSlots},on:{change:e.onBankChange},model:{value:e.bankChose,callback:function(i){e.bankChose=i},expression:"bankChose"}})],1)],1),e._v(" "),e.showCkeck?t("div",{staticClass:"check_bg"}):e._e(),e._v(" "),e.showCkeck?t("div",{staticClass:"checkCode"},[t("div",{staticClass:"check"},[t("div",{staticClass:"iptCode"},[e._v("请输入短信验证码")]),e._v(" "),t("div",{staticClass:"content"},e._l(e.length,function(i,n){return t("div",{key:n},[t("span",{staticClass:"iptbox",on:{click:function(i){return e.tap(n)}}},[e.value.length>=n+1&&e.value[n]?t("span",[e._v(e._s(e.value[n]))]):e._e()])])}),0),e._v(" "),t("input",{ref:"inputVal",staticClass:"ipt",attrs:{name:"password",maxlength:e.length,autocomplete:"off",autofocus:"autofocus",type:"number"},on:{input:e.focus}}),e._v(" "),t("div",{staticClass:"chect_btn"},[t("button",{staticClass:"btn-area",on:{click:e.formSubmits}},[e._v("确认")])])]),e._v(" "),t("div",{staticClass:"check_close",on:{click:e.closeCheck}},[t("i",{staticClass:"iconfont icon-bohui"})])]):e._e()],1)},staticRenderFns:[function(){var e=this.$createElement,i=this._self._c||e;return i("div",{staticClass:"ipt_realInfo"},[i("span",[this._v("请填写本人真实信息，一经绑定，则无法修改")])])}]};var r=t("VU/8")(s,a,!1,function(e){t("PDja")},"data-v-76c1932c",null);i.default=r.exports}});
//# sourceMappingURL=36.fe694a591ebe9c258b69.js.map